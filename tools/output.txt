Simulation/
    +page.svelte
    Contents:
<script lang="ts">
  import InputForm from './InputForm.svelte';
  import SimulationOutput from './SimulationOutput.svelte';

  type SimulationResultType = { Result1: number; Result2: number; } | null;
  let simulationResult: SimulationResultType = null;

  function handleSimulation(event: CustomEvent<SimulationResultType>) {
  simulationResult = event.detail;
}

</script>

<section>
  <h1>Economic Simulation</h1>
  <InputForm on:simulationComplete={handleSimulation} />
  <SimulationOutput {simulationResult} />
</section>


    InputForm.svelte
    Contents:
<script lang="ts">
  import { createEventDispatcher, onMount } from 'svelte';
  import type { FormField, FormStructure, FormData, Category } from '$lib/types/formTypes';

  const dispatch = createEventDispatcher();
  let formStructure: FormStructure = { categories: [] };
  let formData: FormData = {};

  onMount(async () => {
    try {
      const response = await fetch(`${import.meta.env.VITE_API_URL}/api/form-structure`);
      if (response.ok) {
        const data = await response.json();
        formStructure.categories = data.categories;
        formStructure.categories.forEach((category: Category) => {
          formData[category.categoryName] = {}; // Create a nested object for each category
          category.fields.forEach((field: FormField) => {
            formData[category.categoryName][field.name] = field.defaultValue;
          });
        });
      }
    } catch (error) {
      console.error('Error fetching form structure:', error);
    }
  });

  async function submitForm(event: SubmitEvent) {
    event.preventDefault();
    console.log(formData)
    try {
      const response = await fetch(`${import.meta.env.VITE_API_URL}/api/simulate`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(formData),
      });

      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`Failed to run simulation: ${errorText}`);
      }

      const simulationResults = await response.json();
      dispatch('simulationComplete', simulationResults);
    } catch (error: unknown) {
      if (error instanceof Error) {
        console.error('Error:', error.message);
        alert(error.message);
      }
    }
  }
</script>

<form on:submit|preventDefault={submitForm}>
  {#each formStructure.categories as category}
    <fieldset>
      <legend>{category.categoryName}</legend>
      {#each category.fields as field}
        <div class="form-group">
          <label for={`${category.categoryName}-${field.name}`}>{field.name}</label>
          <input id={`${category.categoryName}-${field.name}`}
                 bind:value={formData[category.categoryName][field.name]}
                 type="number" />
        </div>
      {/each}
    </fieldset>
  {/each}
  <button type="submit">Submit</button>
</form>


    SimulationOutput.svelte
    Contents:
<script lang="ts">
  export let simulationResult: { EconomyHealth: number; MarketTrends: number; } | null = null;

  function formatSimulationResult(result: { EconomyHealth: number; MarketTrends: number; }): string {
    return `Economy Heatlth: ${result.EconomyHealth.toFixed(2)}, Market Trends: ${result.MarketTrends.toFixed(2)}`;
  }
</script>

{#if simulationResult}
  <div>
    <h2>Simulation Results</h2>
    <p>{formatSimulationResult(simulationResult)}</p>
  </div>
{:else}
  <p>No results to display</p>
{/if}


